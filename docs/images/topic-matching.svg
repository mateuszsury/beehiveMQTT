<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 460" width="700" height="460">
  <defs>
    <style>
      .title { font-family: 'Segoe UI', Arial, sans-serif; font-size: 16px; font-weight: 700; fill: #1A1A1A; }
      .node-text { font-family: 'Consolas', 'Courier New', monospace; font-size: 11px; fill: #fff; font-weight: 600; }
      .label { font-family: 'Segoe UI', Arial, sans-serif; font-size: 10px; fill: #666; }
      .example-title { font-family: 'Segoe UI', Arial, sans-serif; font-size: 12px; font-weight: 600; fill: #333; }
      .example-text { font-family: 'Consolas', 'Courier New', monospace; font-size: 10px; fill: #1A1A1A; }
      .match { fill: #4CAF50; }
      .nomatch { fill: #F44336; }
    </style>
  </defs>

  <text x="350" y="25" text-anchor="middle" class="title">Topic Tree and Wildcard Matching</text>

  <!-- Trie visualization -->
  <g transform="translate(30, 50)">
    <text x="160" y="0" text-anchor="middle" class="example-title">Subscription Trie Structure</text>

    <!-- Root -->
    <rect x="140" y="10" width="40" height="24" rx="12" fill="#9E9E9E"/>
    <text x="160" y="26" text-anchor="middle" class="node-text">root</text>

    <!-- Level 1 branches -->
    <line x1="160" y1="34" x2="80" y2="55" stroke="#999" stroke-width="1.5"/>
    <line x1="160" y1="34" x2="160" y2="55" stroke="#999" stroke-width="1.5"/>
    <line x1="160" y1="34" x2="240" y2="55" stroke="#999" stroke-width="1.5"/>

    <!-- home -->
    <rect x="45" y="55" width="70" height="24" rx="12" fill="#2196F3"/>
    <text x="80" y="71" text-anchor="middle" class="node-text">home</text>
    <!-- sensor -->
    <rect x="125" y="55" width="70" height="24" rx="12" fill="#2196F3"/>
    <text x="160" y="71" text-anchor="middle" class="node-text">sensor</text>
    <!-- $SYS -->
    <rect x="205" y="55" width="70" height="24" rx="12" fill="#FF5722"/>
    <text x="240" y="71" text-anchor="middle" class="node-text">$SYS</text>

    <!-- Level 2: home children -->
    <line x1="80" y1="79" x2="40" y2="105" stroke="#999" stroke-width="1.5"/>
    <line x1="80" y1="79" x2="80" y2="105" stroke="#999" stroke-width="1.5"/>
    <line x1="80" y1="79" x2="120" y2="105" stroke="#999" stroke-width="1.5"/>

    <rect x="10" y="105" width="60" height="22" rx="11" fill="#4CAF50"/>
    <text x="40" y="120" text-anchor="middle" class="node-text">+</text>
    <rect x="50" y="105" width="60" height="22" rx="11" fill="#2196F3"/>
    <text x="80" y="120" text-anchor="middle" class="node-text">kitchen</text>
    <rect x="90" y="105" width="60" height="22" rx="11" fill="#9C27B0"/>
    <text x="120" y="120" text-anchor="middle" class="node-text">#</text>
    <text x="120" y="140" text-anchor="middle" class="label">[sub: client3]</text>

    <!-- Level 2: sensor children -->
    <line x1="160" y1="79" x2="180" y2="105" stroke="#999" stroke-width="1.5"/>
    <rect x="155" y="105" width="50" height="22" rx="11" fill="#9C27B0"/>
    <text x="180" y="120" text-anchor="middle" class="node-text">#</text>
    <text x="180" y="140" text-anchor="middle" class="label">[sub: client4]</text>

    <!-- Level 2: $SYS children -->
    <line x1="240" y1="79" x2="240" y2="105" stroke="#999" stroke-width="1.5"/>
    <rect x="210" y="105" width="60" height="22" rx="11" fill="#FF5722"/>
    <text x="240" y="120" text-anchor="middle" class="node-text">broker</text>

    <!-- Level 3: home/+/temp and home/kitchen/temp -->
    <line x1="40" y1="127" x2="40" y2="152" stroke="#999" stroke-width="1.5"/>
    <rect x="5" y="152" width="70" height="22" rx="11" fill="#2196F3"/>
    <text x="40" y="167" text-anchor="middle" class="node-text">temp</text>
    <text x="40" y="185" text-anchor="middle" class="label">[sub: client1]</text>

    <line x1="80" y1="127" x2="80" y2="152" stroke="#999" stroke-width="1.5"/>
    <rect x="50" y="152" width="60" height="22" rx="11" fill="#2196F3"/>
    <text x="80" y="167" text-anchor="middle" class="node-text">temp</text>
    <text x="80" y="185" text-anchor="middle" class="label">[sub: client2]</text>

    <!-- Level 3: $SYS/broker children -->
    <line x1="240" y1="127" x2="240" y2="152" stroke="#999" stroke-width="1.5"/>
    <rect x="205" y="152" width="70" height="22" rx="11" fill="#FF5722"/>
    <text x="240" y="167" text-anchor="middle" class="node-text">uptime</text>
    <text x="240" y="185" text-anchor="middle" class="label">[sub: client5]</text>

    <!-- Legend -->
    <g transform="translate(0, 200)">
      <rect x="0" y="0" width="16" height="12" rx="6" fill="#2196F3"/>
      <text x="22" y="10" class="label">Exact level</text>
      <rect x="80" y="0" width="16" height="12" rx="6" fill="#4CAF50"/>
      <text x="102" y="10" class="label">+ wildcard</text>
      <rect x="160" y="0" width="16" height="12" rx="6" fill="#9C27B0"/>
      <text x="182" y="10" class="label"># wildcard</text>
      <rect x="240" y="0" width="16" height="12" rx="6" fill="#FF5722"/>
      <text x="262" y="10" class="label">$SYS (system)</text>
    </g>
  </g>

  <!-- Examples -->
  <g transform="translate(370, 50)">
    <text x="150" y="0" text-anchor="middle" class="example-title">Matching Examples</text>

    <!-- Example table header -->
    <rect x="0" y="12" width="300" height="22" rx="4" fill="#F5F5F5"/>
    <text x="10" y="27" class="example-text" font-weight="bold">Publish Topic</text>
    <text x="155" y="27" class="example-text" font-weight="bold">Matched By</text>

    <!-- Row 1 -->
    <text x="10" y="50" class="example-text">home/kitchen/temp</text>
    <text x="155" y="50" class="example-text match">client1 (+/temp)</text>
    <text x="155" y="62" class="example-text match">client2 (kitchen/temp)</text>
    <text x="155" y="74" class="example-text match">client3 (home/#)</text>

    <!-- Row 2 -->
    <line x1="0" y1="82" x2="300" y2="82" stroke="#eee"/>
    <text x="10" y="97" class="example-text">home/bedroom/temp</text>
    <text x="155" y="97" class="example-text match">client1 (+/temp)</text>
    <text x="155" y="109" class="example-text match">client3 (home/#)</text>

    <!-- Row 3 -->
    <line x1="0" y1="117" x2="300" y2="117" stroke="#eee"/>
    <text x="10" y="132" class="example-text">home/kitchen/humid</text>
    <text x="155" y="132" class="example-text match">client3 (home/#)</text>

    <!-- Row 4 -->
    <line x1="0" y1="140" x2="300" y2="140" stroke="#eee"/>
    <text x="10" y="155" class="example-text">sensor/data</text>
    <text x="155" y="155" class="example-text match">client4 (sensor/#)</text>

    <!-- Row 5 -->
    <line x1="0" y1="163" x2="300" y2="163" stroke="#eee"/>
    <text x="10" y="178" class="example-text">$SYS/broker/uptime</text>
    <text x="155" y="178" class="example-text match">client5 ($SYS/...)</text>
    <text x="155" y="190" class="example-text nomatch">NOT client3 (#)</text>
  </g>

  <!-- Wildcard rules -->
  <g transform="translate(30, 300)">
    <text x="320" y="0" text-anchor="middle" class="example-title">Wildcard Rules Summary</text>

    <!-- + wildcard -->
    <rect x="0" y="15" width="210" height="130" rx="6" fill="#E8F5E9" stroke="#4CAF50" stroke-width="1.5"/>
    <text x="105" y="35" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14px" font-weight="700" fill="#4CAF50">+ Single Level</text>
    <text x="15" y="55" class="example-text">home/+/temp</text>
    <text x="15" y="72" class="example-text match">  home/kitchen/temp</text>
    <text x="15" y="87" class="example-text match">  home/bedroom/temp</text>
    <text x="15" y="102" class="example-text nomatch">  home/a/b/temp</text>
    <text x="15" y="117" class="example-text nomatch">  home/temp</text>
    <text x="15" y="135" class="label">Matches exactly ONE level</text>

    <!-- # wildcard -->
    <rect x="230" y="15" width="210" height="130" rx="6" fill="#F3E5F5" stroke="#9C27B0" stroke-width="1.5"/>
    <text x="335" y="35" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14px" font-weight="700" fill="#9C27B0"># Multi Level</text>
    <text x="245" y="55" class="example-text">sensor/#</text>
    <text x="245" y="72" class="example-text match">  sensor</text>
    <text x="245" y="87" class="example-text match">  sensor/temp</text>
    <text x="245" y="102" class="example-text match">  sensor/a/b/c</text>
    <text x="245" y="117" class="example-text nomatch">  home/sensor</text>
    <text x="245" y="135" class="label">Matches ZERO or more levels</text>

    <!-- $SYS rule -->
    <rect x="460" y="15" width="210" height="130" rx="6" fill="#FBE9E7" stroke="#FF5722" stroke-width="1.5"/>
    <text x="565" y="35" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14px" font-weight="700" fill="#FF5722">$ System Topics</text>
    <text x="475" y="55" class="example-text"># does NOT match $SYS</text>
    <text x="475" y="72" class="example-text">+ does NOT match $SYS</text>
    <text x="475" y="92" class="example-text match">$SYS/# matches all</text>
    <text x="475" y="107" class="example-text match">$SYS/+/uptime works</text>
    <text x="475" y="135" class="label">Must subscribe explicitly</text>
  </g>
</svg>